!function(e){var t,a,o=e(window).width(),s={cntClass:"rd-mobilemenu",menuClass:"rd-mobilemenu_ul",submenuClass:"rd-mobilemenu_submenu",panelClass:"rd-mobilepanel",toggleClass:"rd-mobilepanel_toggle",titleClass:"rd-mobilepanel_title"},n=0,i=function(t,a){this.options=a,this.$source=e(t)};i.prototype={init:function(){var e=this;e.createDOM(),e.createListeners()},createDOM:function(){var t=this;e(".rd-mobilemenu").append(t.createNavDOM()),e("html").hasClass("desktop")&&o>=1600?(e("body").delegate("*","mousewheel",t.scroll),e("body").delegate("*","touchmove",t.scroll),e("body").delegate("*","touchend",t.touchend),e("body").delegate("*","touchstart",{type:"click"},t.close)):e(".rd-mobilepanel_toggle, .page-content, .rd-mobilemenu").removeClass("active")},createNavDOM:function(){for(var t=this,a=e("<ul>",{"class":s.menuClass}),o=t.$source.children(),n=0;n<o.length;n++){for(var i=o[n].children,l=null,r=0;r<i.length;r++)if(i[r].tagName)switch(l||(l=document.createElement("li"),o[n].className.indexOf("active")>-1&&(l.className="active")),i[r].tagName.toLowerCase()){case"a":var c=i[r].cloneNode(!0);l.appendChild(c);break;case"ul":var d=i[r].cloneNode(!0);d.className=s.submenuClass,l.appendChild(d),e(l).find("> a").hasClass("opened")||e(d).css({display:"none"}),e(l).find("> a").each(function(){$this=e(this),$this.addClass("rd-with-ul").on("click",function(t){if(t.preventDefault(),$this=e(this),$this.hasClass("rd-with-ul")&&!$this.hasClass("active")){e(".rd-with-ul").removeClass("active");var a=$this.addClass("active").parent().find("."+s.submenuClass);a.stop().slideDown(),e("."+s.submenuClass).not(a).stop().slideUp()}else{var a=$this.removeClass("active").parent().find("."+s.submenuClass);a.stop().slideUp()}})})}l&&a.append(l)}return a.find("a").each(function(){window.location.href.indexOf(e(this).attr("href"))>-1&&(e(this).parents(".rd-mobilemenu_ul").find("a").removeClass("focus"),e(this).addClass("focus"))}),a},createListeners:function(){var t=this;t.panelHeight=e(".rd-mobilepanel").outerHeight(),t.createToggleListener(),t.createResizeListener(),t.createScrollListener(),t.createItemScrollListener()},createToggleListener:function(){var t,a=this;t=a.isMobile()?"touchstart":"click",e("body").delegate("."+s.toggleClass,t,function(t){t.preventDefault(),t.stopPropagation();var o=e("."+s.cntClass);e(this).toggleClass("active"),e(".page-content").toggleClass("active"),console.log("toggle"),o.hasClass("active")?(e(this).removeClass("active"),o.removeClass("active"),e("body").undelegate("*","mousewheel",a.scroll),e("body").undelegate("*","touchmove",a.scroll),e("body").undelegate("*","touchend",a.touchend)):(e(this).addClass("active"),o.addClass("active"),e("body").delegate("*","mousewheel",a.scroll),e("body").delegate("*","touchmove",a.scroll),e("body").delegate("*","touchend",a.touchend))})},createResizeListener:function(){var t=this;e(window).on("resize",function(){var a=e("."+s.cntClass);"none"==a.css("display")&&(a.removeClass("active"),e("."+s.toggleClass).removeClass("active"),e("body").undelegate("*","mousewheel",t.scroll),e("body").undelegate("*","touchmove",t.scroll),e("body").undelegate("*","touchend",t.touchend))})},createScrollListener:function(){function t(){function t(){n.removeClass("fixed"),e("body").removeClass("navbar-stickup").removeClass("navbar-fixed"),o="default"==e("body").data("project")?65:"lunalin"==e("body").data("project")?95:"watchelli"==e("body").data("project")?60:70,r>a&&!n.hasClass("fixed")?(i.css({transform:"translateY("+r/3+"px)","font-size":o-r/6.7}),l.css({display:"none",transform:"translateY("+r/3+"px)"})):(i.css({transform:"translateY("+r/3+"px)","font-size":o-r/6.7}),l.css({display:"block",transform:"translateY("+r/3+"px)"}))}function s(){n.addClass("fixed"),i.css({transform:"translateY(50.25px)","font-size":24}),l.css({display:"none"})}var n=e(".rd-mobilepanel"),i=e(".rd-mobilepanel_title"),l=e(".tm-title-caption"),r=e(document).scrollTop(),c=e("body").data("project"),d="";d="default"==c||"eveprest"==c?130:300,e(window).width()>1067?d>r&&"introduction"===e("body").data("section")?t():(s(),e("body").removeClass("navbar-stickup").addClass("navbar-fixed")):(s(),e("body").removeClass("navbar-stickup").addClass("navbar-fixed")),a=r}var a=(e(".rd-mobilepanel"),0),o=65;e(window).on("scroll",t),e(window).on("resize",t),t()},createItemScrollListener:function(){function t(){var t,a=e(document).scrollTop(),o=e(".rd-mobilemenu_ul > li > a.rd-with-ul");o.each(function(){window.location.search.indexOf(e(this).attr("data-id"))>-1&&(t=e(this).parent().find(".rd-mobilemenu_submenu"))}),t&&(a+e(window).height()>e(document).height()-100?(t.find("a").removeClass("focus"),t.find("> li:last-child a").addClass("focus")):t.find("a").each(function(){var t=e(this),o=e("#"+t.attr("data-id"));o.length>0&&o.offset().top-20<=a&&o.offset().top+o.height()>a&&(t.parents(".rd-mobilemenu_ul").find("a").removeClass("focus"),t.addClass("focus"))}))}e(".rd-mobilemenu_ul").find('a[href*="#"]').on("click",function(t){if(-1==window.location.search.indexOf(e(this).attr("data-section")))return!0;t.preventDefault(),e(this).parents(".rd-mobilemenu_ul").find("a").removeClass("focus"),e(this).addClass("focus");var a=this.hash;if(console.log(this.hash),""==this.hash)e("html, body").stop().animate({scrollTop:0},300,"swing",function(){window.location.hash=a});else{var o=e(a);e("html, body").stop().animate({scrollTop:o.offset().top+2},300,"swing",function(){window.location.hash=a})}}),e(document).on("scroll",t)},scroll:function(o){var s=e(".rd-mobilemenu_ul"),i=o.originalEvent.targetTouches?o.originalEvent.targetTouches[0].pageX:o.pageX,l=o.originalEvent.targetTouches?o.originalEvent.targetTouches[0].pageY:o.pageY;if(l>s.offset().top&&l<s.offset().top+s.outerHeight()&&i>s.offset().left&&i<s.offset().left+s.outerWidth()){var r=0;if(o.originalEvent.targetTouches)t||(t=l),r=t-l,t=l,a=r>0;else{var c=(new Date).getTime();if(40>c-n)return n=c,void 0;n=c,r=-25*(o.originalEvent.wheelDelta||-o.originalEvent.detail)}s.stop().scrollTop(s.scrollTop()+r)}else if(e("html").hasClass("desktop"))return!0;return o.preventDefault(),!1},touchend:function(){var o=e("."+s.menuClass);o.stop().animate({scrollTop:o.scrollTop()+(a?100:-100)},3e3,"easeOutQuint"),t=void 0},close:function(t){if(t.originalEvent){var a=e(".rd-mobilemenu"),o=t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageX:t.pageX,n=t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageY:t.pageY;n>a.offset().top&&n<a.offset().top+a.outerHeight()&&o>a.offset().left&&o<a.offset().left+a.outerWidth()||e("."+s.toggleClass).trigger(t.data.type)}},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}},e.fn.rdparallax=function(){var e=this;return e.length&&new i(e[0]).init(),e},window.RDMobilemenu_autoinit=function(t){var a=e(t);a.length&&new i(a[0]).init()}}(jQuery),$(document).ready(function(){RDMobilemenu_autoinit('[data-type="navbar"]')});